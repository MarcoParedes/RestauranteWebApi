/
OD:\Proyectos\RestauranteWebApi\Restaurante.Solution\Restaurante.Business\AES.cs
	namespace 	
Restaurante
 
. 
Business 
{ 
public 

class 
AES 
{		 
private

 
static

 
AES

 
Instance

 #
;

# $
private 
static 
byte 
[ 
] 
password &
=' (
{) *
$num+ ,
,, -
$num. 0
,0 1
$num2 4
,4 5
$num6 9
,9 :
$num; =
,= >
$num? A
,A B
$numC E
,E F
$numG I
,I J
$numK N
,N O
$numP S
,S T
$numU W
,W X
$numY \
,\ ]
$num^ `
,` a
$numb e
,e f
$numg j
,j k
$numl o
,o p
$numq t
,t u
$numv x
,x y
$numz }
,} ~
$num	 Ç
,
Ç É
$num
Ñ á
,
á à
$num
â ã
,
ã å
$num
ç ê
,
ê ë
$num
í î
,
î ï
$num
ñ ò
,
ò ô
$num
ö ú
,
ú ù
$num
û †
,
† °
$num
¢ •
,
• ¶
$num
ß ™
,
™ ´
$num
¨ Ø
,
Ø ∞
$num
± ≥
,
≥ ¥
$num
µ ∏
}
π ∫
;
∫ ª
private 
static 
byte 
[ 
] 
vector $
=% &
{' (
$num) ,
,, -
$num. 0
,0 1
$num2 5
,5 6
$num7 :
,: ;
$num< ?
,? @
$numA B
,B C
$numD E
,E F
$numG H
,H I
$numJ M
,M N
$numO R
,R S
$numT W
,W X
$numY \
,\ ]
$num^ `
,` a
$numb d
,d e
$numf i
,i j
$numk l
}m n
;n o
private 
ICryptoTransform  
	Encryptor! *
,* +
	Decryptor, 5
;5 6
private 
UTF8Encoding 
UTF8 !
;! "
public 
AES 
( 
) 
{ 	
RijndaelManaged 
Managed #
=$ %
new& )
RijndaelManaged* 9
(9 :
): ;
;; <
	Encryptor 
= 
Managed 
.  
CreateEncryptor  /
(/ 0
password0 8
,8 9
vector: @
)@ A
;A B
	Decryptor 
= 
Managed 
.  
CreateDecryptor  /
(/ 0
password0 8
,8 9
vector: @
)@ A
;A B
UTF8 
= 
new 
UTF8Encoding #
(# $
)$ %
;% &
} 	
public 
static 
AES 
GetInstance %
(% &
)& '
{ 	
if 
( 
Instance 
== 
null  
)  !
Instance 
= 
new 
AES "
(" #
)# $
;$ %
return 
Instance 
; 
} 	
public!! 
string!! 
Encrypt!! 
(!! 
string!! $
value!!% *
)!!* +
{"" 	
byte## 
[## 
]## 
Buffer## 
=## 
	Transform## %
(##% &
UTF8##& *
.##* +
GetBytes##+ 3
(##3 4
value##4 9
)##9 :
,##: ;
	Encryptor##< E
)##E F
;##F G
return$$ 
Convert$$ 
.$$ 
ToBase64String$$ )
($$) *
Buffer$$* 0
)$$0 1
;$$1 2
}%% 	
public'' 
string'' 
Decrypt'' 
('' 
string'' $
value''% *
)''* +
{(( 	
byte)) 
[)) 
])) 
Buffer)) 
=)) 
Convert)) #
.))# $
FromBase64String))$ 4
())4 5
value))5 :
))): ;
;)); <
Buffer** 
=** 
	Transform** 
(** 
Buffer** %
,**% &
	Decryptor**' 0
)**0 1
;**1 2
return++ 
UTF8++ 
.++ 
	GetString++ !
(++! "
Buffer++" (
)++( )
;++) *
},, 	
private.. 
byte.. 
[.. 
].. 
	Transform..  
(..  !
byte..! %
[..% &
]..& '
buffer..( .
,... /
ICryptoTransform..0 @
transformer..A L
)..L M
{// 	
MemoryStream00 
Stream00 
=00  !
new00" %
MemoryStream00& 2
(002 3
)003 4
;004 5
using11 
(11 
var11 
Crypto11 
=11 
new11  #
CryptoStream11$ 0
(110 1
Stream111 7
,117 8
transformer119 D
,11D E
CryptoStreamMode11F V
.11V W
Write11W \
)11\ ]
)11] ^
{22 
Crypto33 
.33 
Write33 
(33 
buffer33 #
,33# $
$num33% &
,33& '
buffer33( .
.33. /
Length33/ 5
)335 6
;336 7
}44 
return55 
Stream55 
.55 
ToArray55 !
(55! "
)55" #
;55# $
}66 	
}77 
}88 ΩD
UD:\Proyectos\RestauranteWebApi\Restaurante.Solution\Restaurante.Business\PlatosBiz.cs
	namespace		 	
Restaurante		
 
.		 
Business		 
{

 
public 

class 
	PlatosBiz 
: 

IPlatosBiz '
{ 
	protected 
readonly !
IContextDbRestaurante 0
_context1 9
;9 :
public 
	PlatosBiz 
( 
) 
{ 	
} 	
public 
	PlatosBiz 
( !
IContextDbRestaurante .
ctx/ 2
)2 3
{ 	
_context 
= 
ctx 
; 
} 	
private !
IContextDbRestaurante %

GetContext& 0
(0 1
)1 2
{ 	
return 
_context 
?? 
new "
RestauranteEntities# 6
(6 7
)7 8
;8 9
} 	
public !
ObtenerPlatosResponse $
ObtenerPlatoPorTipo% 8
(8 9
int9 <
idTipoPlato= H
)H I
{ 	
using 
( 
var 
context 
=  

GetContext! +
(+ ,
), -
)- .
{   
var!! 
platos!! 
=!! 
context!! $
.!!$ %
Platos!!% +
."" 
Where"" 
("" 
x""  
=>""! #
x""$ %
.""% &
IdTipo""& ,
==""- /
idTipoPlato""0 ;
)""; <
.## 
Select## 
(##  
x##  !
=>##" $
new##% (
{$$ 
x%% 
.%% 
Id%%  
,%%  !
x&& 
.&& 
Nombres&& %
,&&% &
x'' 
.'' 
Descripcion'' )
,'') *
x(( 
.(( 
Imagen(( $
,(($ %
x)) 
.)) 
Precio)) $
,))$ %
x** 
.** 
Etiqueta** &
}++ 
)++ 
.++ 
ToList++ !
(++! "
)++" #
;++# $
var-- 
response-- 
=-- 
new-- "!
ObtenerPlatosResponse--# 8
(--8 9
)--9 :
;--: ;
response.. 
... 

platosList.. #
=..$ %
platos..& ,
.// 
Select// 
(// 
x// 
=>//  
new//! $

PlatoModel//% /
{00 
id11 
=11 
x11 
.11 
Id11 !
,11! "
nombre22 
=22  
x22! "
.22" #
Nombres22# *
,22* +
descripcion33 #
=33$ %
x33& '
.33' (
Descripcion33( 3
,333 4
precio44 
=44  
x44! "
.44" #
Precio44# )
,44) *
imagen55 
=55  
x55! "
.55" #
Imagen55# )
}66 
)66 
.66 
ToList66 
(66 
)66 
;66  
return88 
response88 
;88  
}99 
}:: 	
public<< '
ObtenerDetallePlatoResponse<< *
ObtenerDetallePlato<<+ >
(<<> ?&
ObtenerDetallePlatoRequest<<? Y
request<<Z a
)<<a b
{== 	
using>> 
(>> 
var>> 
context>> 
=>>  

GetContext>>! +
(>>+ ,
)>>, -
)>>- .
{?? 
var@@ 
plato@@ 
=@@ 
context@@ #
.@@# $
Platos@@$ *
.AA 
WhereAA 
(AA 
xAA 
=>AA 
xAA  !
.AA! "
IdAA" $
==AA% '
requestAA( /
.AA/ 0
idPlatoAA0 7
)AA7 8
.BB 
SelectBB 
(BB 
xBB 
=>BB  
newBB! $
{CC 
xDD 
.DD 
IdDD 
,DD 
xEE 
.EE 
NombresEE !
,EE! "
xFF 
.FF 
DescripcionFF %
,FF% &
xGG 
.GG 
ImagenGG  
,GG  !
xHH 
.HH 
PrecioHH  
,HH  !
xII 
.II 
EtiquetaII "
,II" #
comentariosJJ #
=JJ$ %
contextJJ& -
.JJ- .
ComentariosJJ. 9
.KK 
JoinKK !
(KK! "
contextKK" )
.KK) *
UsuariosKK* 2
,KK2 3
commentLL #
=>LL$ &
commentLL' .
.LL. /
	IdUsuarioLL/ 8
,LL8 9
userMM  
=>MM! #
userMM$ (
.MM( )
IdMM) +
,MM+ ,
(NN 
commentNN $
,NN$ %
userNN& *
)NN* +
=>NN, .
newNN/ 2
{OO 
commentPP  '
.PP' (
IdPP( *
,PP* +
commentQQ  '
.QQ' (
IdPlatoQQ( /
,QQ/ 0
commentRR  '
.RR' (
PuntajeRR( /
,RR/ 0

comentarioSS  *
=SS+ ,
commentSS- 4
.SS4 5
Comentario1SS5 @
,SS@ A
commentTT  '
.TT' (
FechaTT( -
,TT- .
usuarioUU  '
=UU( )
newUU* -
{VV  !
	IdUsuarioWW$ -
=WW. /
userWW0 4
.WW4 5
IdWW5 7
,WW7 8
userXX$ (
.XX( )
NombreCompletoXX) 7
,XX7 8
userYY$ (
.YY( )
CorreoYY) /
}ZZ  !
}[[ 
)[[ 
.\\ 
Where\\ "
(\\" #
d\\# $
=>\\% '
d\\( )
.\\) *
IdPlato\\* 1
==\\2 4
request\\5 <
.\\< =
idPlato\\= D
)\\D E
.\\E F
ToList\\F L
(\\L M
)\\M N
}]] 
)]] 
.]] 
SingleOrDefault]] &
(]]& '
)]]' (
;]]( )
if__ 
(__ 
plato__ 
!=__ 
null__ !
)__! "
{`` 
varaa 
responseaa  
=aa! "
newaa# &'
ObtenerDetallePlatoResponseaa' B
(aaB C
)aaC D
{bb 
detallePlatocc $
=cc% &
{cc' (
platodd !
=dd" #
{dd$ %
idee  "
=ee# $
platoee% *
.ee* +
Idee+ -
,ee- .
nombreff  &
=ff' (
platoff) .
.ff. /
Nombresff/ 6
,ff6 7
descripciongg  +
=gg, -
platogg. 3
.gg3 4
Descripciongg4 ?
,gg? @
imagenhh  &
=hh' (
platohh) .
.hh. /
Imagenhh/ 5
,hh5 6
precioii  &
=ii' (
platoii) .
.ii. /
Precioii/ 5
,ii5 6
comentariosjj  +
=jj, -
platojj. 3
.jj3 4
comentariosjj4 ?
.jj? @
Selectjj@ F
(jjF G
xjjG H
=>jjI K
newjjL O
ComentarioModeljjP _
{kk  !
idComentarioll$ 0
=ll1 2
xll3 4
.ll4 5
Idll5 7
,ll7 8
idPlatomm$ +
=mm, -
xmm. /
.mm/ 0
IdPlatomm0 7
,mm7 8
usuarionn$ +
=nn, -
newnn. 1
UsuarioModelnn2 >
{oo$ %
idpp( *
=pp+ ,
xpp- .
.pp. /
usuariopp/ 6
.pp6 7
	IdUsuariopp7 @
,pp@ A
correoqq( .
=qq/ 0
xqq1 2
.qq2 3
usuarioqq3 :
.qq: ;
Correoqq; A
,qqA B
nombreCompletorr( 6
=rr7 8
xrr9 :
.rr: ;
usuariorr; B
.rrB C
NombreCompletorrC Q
}ss$ %
,ss% &

comentariott$ .
=tt/ 0
xtt1 2
.tt2 3

comentariott3 =
,tt= >
fechauu$ )
=uu* +
xuu, -
.uu- .
Fechauu. 3
,uu3 4
puntajevv$ +
=vv, -
xvv. /
.vv/ 0
Puntajevv0 7
}ww  !
)ww! "
.ww" #
ToListww# )
(ww) *
)ww* +
}xx 
}yy 
}zz 
;zz 
return{{ 
response{{ #
;{{# $
}|| 
return}} 
null}} 
;}} 
}~~ 
}
ÄÄ 	
}
ÉÉ 
}ÑÑ é
cD:\Proyectos\RestauranteWebApi\Restaurante.Solution\Restaurante.Business\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str /
)/ 0
]0 1
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 1
)1 2
]2 3
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *Î
XD:\Proyectos\RestauranteWebApi\Restaurante.Solution\Restaurante.Business\TipoPlatoBiz.cs
	namespace		 	
Restaurante		
 
.		 
Business		 
{

 
public 

class 
TipoPlatoBiz 
: 
ITipoPlatoBiz  -
{ 
private !
IContextDbRestaurante %
_context& .
;. /
public 
TipoPlatoBiz 
( 
) 
{ 
}  !
public 
TipoPlatoBiz 
( !
IContextDbRestaurante 1
ctx2 5
)5 6
{ 	
_context 
= 
ctx 
; 
} 	
private !
IContextDbRestaurante %

GetContext& 0
(0 1
)1 2
{ 	
return 
_context 
?? 
new "
RestauranteEntities# 6
(6 7
)7 8
;8 9
} 	
public 
TipoPlatoResponse  
ObtenerTipoPlato! 1
(1 2
)2 3
{ 	
using 
( 
var 
context 
=  

GetContext! +
(+ ,
), -
)- .
{ 
var 
query 
= 
context #
.# $
TipoPlatoes$ /
.    !
Select  ! '
(  ' (
x  ( )
=>  * ,
new  - 0
{!!  !
x""$ %
.""% &
Id""& (
,""( )
x##$ %
.##% &
Imagen##& ,
,##, -
x$$$ %
.$$% &
Estado$$& ,
,$$, -
x%%$ %
.%%% &
Descripcion%%& 1
}&&  !
)&&! "
;&&" #
var(( 
response(( 
=(( 
new(( "
TipoPlatoResponse((# 4
(((4 5
)((5 6
;((6 7
response)) 
.)) 
TipoPlatoList)) &
=))' (
query))) .
.** 
Select** 
(** 
x** 
=>**  
new**! $
TipoPlatoModel**% 3
{++ 
id,, 
=,, 
x,, 
.,, 
Id,, !
,,,! "
descripcion-- #
=--$ %
x--& '
.--' (
Descripcion--( 3
,--3 4
imagen.. 
=..  
x..! "
..." #
Imagen..# )
,..) *
estado// 
=//  
x//! "
.//" #
Estado//# )
??//* ,
default//- 4
(//4 5
bool//5 9
)//9 :
}00 
)00 
.00 
ToList00 
(00 
)00 
;00  
return11 
response11 
;11  
}22 
}33 	
}55 
}66  &
VD:\Proyectos\RestauranteWebApi\Restaurante.Solution\Restaurante.Business\UsuarioBiz.cs
	namespace 	
Restaurante
 
. 
Business 
{		 
public

 

class

 

UsuarioBiz

 
:

 
IUsuarioBiz

 )
{ 
public 
UsuarioResponse 
RegistrarUsuario /
(/ 0
UsuarioRequest0 >
request? F
)F G
{ 	
UsuarioResponse 
response $
=% &
null' +
;+ ,
Usuario 
usuario 
= 
new !
Usuario" )
() *
)* +
;+ ,
usuario 
. 
NombreCompleto "
=# $
request% ,
., -
nombreCompleto- ;
;; <
usuario 
. 
Edad 
= 
request "
." #
edad# '
;' (
usuario 
. 
Correo 
= 
request $
.$ %
correo% +
;+ ,
var 
password 
= 
AES 
. 
GetInstance *
(* +
)+ ,
., -
Encrypt- 4
(4 5
request5 <
.< =
clave= B
)B C
;C D
usuario 
. 
Clave 
= 
password $
;$ %
using 
( 
var 
context 
=  
new! $
RestauranteEntities% 8
(8 9
)9 :
): ;
{ 
var 
exists 
= 
context $
.$ %
Usuarios% -
.- .
Any. 1
(1 2
x2 3
=>4 6
x7 8
.8 9
Correo9 ?
==@ B
usuarioC J
.J K
CorreoK Q
)Q R
;R S
if 
( 
! 
exists 
) 
{ 
context 
. 
Usuarios $
.$ %
Add% (
(( )
usuario) 0
)0 1
;1 2
int 
result 
=  
context! (
.( )
SaveChanges) 4
(4 5
)5 6
;6 7
response 
= 
new "
UsuarioResponse# 2
(2 3
)3 4
{   
correo!! 
=!!  
usuario!!! (
.!!( )
Correo!!) /
,!!/ 0
nombreCompleto"" &
=""' (
usuario"") 0
.""0 1
NombreCompleto""1 ?
}## 
;## 
response%% 
=%% 
result%% %
==%%& (
$num%%) *
?%%+ ,
response%%- 5
:%%6 7
null%%8 <
;%%< =
}&& 
return'' 
response'' 
;''  
}(( 
})) 	
public++ 
bool++ 
Ingresar++ 
(++ 
UsuarioRequest++ +
request++, 3
)++3 4
{,, 	
var-- 
password-- 
=-- 
AES-- 
.-- 
GetInstance-- *
(--* +
)--+ ,
.--, -
Encrypt--- 4
(--4 5
request--5 <
.--< =
clave--= B
)--B C
;--C D
using.. 
(.. 
var.. 
context.. 
=..  
new..! $
RestauranteEntities..% 8
(..8 9
)..9 :
)..: ;
{// 
var00 
data00 
=00 
context00 "
.00" #
Usuarios00# +
.00+ ,
SingleOrDefault00, ;
(00; <
x00< =
=>00> @
x00A B
.00B C
Correo00C I
==00J L
request00M T
.00T U
correo00U [
)00[ \
;00\ ]
var11 
clave11 
=11 
AES11 
.11  
GetInstance11  +
(11+ ,
)11, -
.11- .
Decrypt11. 5
(115 6
data116 :
.11: ;
Clave11; @
)11@ A
;11A B
bool22 
exists22 
=22 
context22 %
.22% &
Usuarios22& .
.22. /
Any22/ 2
(222 3
x223 4
=>225 7
x228 9
.229 :
Correo22: @
==22A C
request22D K
.22K L
correo22L R
&&22S U
x22V W
.22W X
Clave22X ]
==22^ `
password22a i
)22i j
;22j k
return33 
exists33 
;33 
}44 
}55 	
}77 
}88 